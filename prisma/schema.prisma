generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           Int          @id @default(autoincrement())
  username     String       @unique
  passwordHash String       @map("password_hash")
  role         String       @default("user")
  createdAt    DateTime     @default(now()) @map("created_at")
  updatedAt    DateTime     @updatedAt @map("updated_at")
  familyTrees  FamilyTree[]

  @@map("users")
}

model SystemStatus {
  id           Int      @id @default(autoincrement())
  component    String   @unique
  status       String
  lastChecked  DateTime @default(now()) @map("last_checked")
  details      String?
  responseTime Int?     @map("response_time")

  @@map("system_status")
}

model OracleMemory {
  id           Int      @id @default(autoincrement())
  label        String   @unique
  description  String
  content      String
  memoryType   String   @map("memory_type")
  status       String   @default("active")
  createdBy    String   @map("created_by")
  createdAt    DateTime @default(now()) @map("created_at")
  lastModified DateTime @updatedAt @map("last_modified")

  @@map("oracle_memory")
}

model ModuleIntegration {
  id                String   @id @default(cuid())
  moduleName        String   @unique @map("module_name")
  displayName       String   @map("display_name")
  isConnected       Boolean  @default(false) @map("is_connected")
  integrationType   String?  @map("integration_type")
  integrationUrl    String?  @map("integration_url")
  integrationScript String?  @map("integration_script")
  integrationEmbed  String?  @map("integration_embed")
  integrationConfig Json?    @map("integration_config")
  connectedAppName  String?  @map("connected_app_name")
  createdAt         DateTime @default(now()) @map("created_at")
  updatedAt         DateTime @default(now()) @updatedAt @map("updated_at")

  @@map("module_integrations")
}

model FamilyTree {
  id         String   @id @default(cuid())
  userId     Int      @map("user_id")
  filename   String
  data       Json
  uploadedAt DateTime @default(now()) @map("uploaded_at")
  user       User     @relation(fields: [userId], references: [id])

  @@map("family_trees")
}
